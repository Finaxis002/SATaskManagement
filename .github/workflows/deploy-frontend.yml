name: Test GitHub SSH Access

on: workflow_dispatch

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Test SSH
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
          SERVER_IP: ${{ secrets.SERVER_IP }}
        run: |
          echo "Testing from GitHub Actions..."
          echo "Runner IP: $(curl -s ifconfig.me)"
          
          mkdir -p ~/.ssh
          echo "$SSH_PRIVATE_KEY" > ~/.ssh/key
          chmod 600 ~/.ssh/key
          
          ssh -o ConnectTimeout=30 \
              -o StrictHostKeyChecking=no \
              -i ~/.ssh/key \
              finaxis_in@$SERVER_IP "echo 'SUCCESS: GitHub can connect!'"